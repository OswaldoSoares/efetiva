{% extends 'minutas/baseminutas.html' %}
{% load permission_tags %}

{% block mainminuta %}

<main class="index-minuta">
    <div class="col-01">
        <div class="article">
            <article class="article-card ac-lista">
                <div class="article-minuta-titulo">
                    <span>ABERTA</span>
                </div>
                {% for minutas in m_aberta %}
                <div class="ac-minuta-base">
                    <div class="ac-itens">
                        <div class="dados-minuta">
                            <div class="linha-minuta"> 
                                <i class="bi bi-file-text">
                                    <span>{{ minutas.Minuta }}</span> 
                                    <span>{{ minutas.Data }}</span>
                                    <span>{{ minutas.Hora }}</span>
                                </i> 
                            </div>
                            <div class="linha-minuta">
                                <i class="bi bi-building">
                                    <span>{{ minutas.Cliente }}</span>
                                </i>
                            </div>
                        </div>
                        <div class="dados-minuta">
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Motorista %}
                                <i class="bi bi-person-square">
                                    <span>{{ minutas.Motorista }}</span>
                                </i>
                                {% endif %}
                            </div>
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Veiculo %}
                                <i class="bi bi-truck">
                                    <span>{{ minutas.Veiculo }}</span>
                                </i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="icones-minuta">
                        {% if itens.StatusMinuta == 'FECHADA' or itens.StatusMinuta == 'CONCLUIDA'%}
                        {% if user|can:'estorna_minuta' %}
                        <i class="bi bi-reply-all i-button"
                            onclick="window.location.href = '{% url 'estorna_minuta' minutas.idMinuta %}'">
                        </i>
                        {% endif %}
                        {% endif %}
                        <i class="bi bi-printer i-button"
                                onclick="window.location.href = '{% url 'imprimeminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'consultaminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'minuta' minutas.idMinuta %}'">
                        </i>
                    </div>
                </div>
                <div class="linha-divisoria"></div>
                {% endfor %}
                <div class="article-minuta-rodape">
                    {% if t_aberta %}
                        {% if t_aberta == 1 %}
                        <span>{{ t_aberta }} MINUTA ABERTA </span>
                        {% else %}
                        <span>{{ t_aberta }} MINUTAS ABERTAS </span>
                        {% endif %}
                    {% else %}
                    <span>NENHUMA MINUTA ABERTA </span>
                    {% endif %}
                </div>
            </article>
            <article class="article-card ac-lista">
                <div class="article-minuta-titulo">
                    <span>CONCLUÍDA</span>
                </div>
                {% for minutas in m_concluida %}
                <div class="ac-minuta-base">
                    <div class="ac-itens">
                        <div class="dados-minuta">
                            <div class="linha-minuta"> 
                                <i class="bi bi-file-text">
                                    <span>{{ minutas.Minuta }}</span> 
                                    <span>{{ minutas.Data }}</span>
                                    <span>{{ minutas.Hora }}</span>
                                </i> 
                            </div>
                            <div class="linha-minuta">
                                <i class="bi bi-building">
                                    <span>{{ minutas.Cliente }}</span>
                                </i>
                            </div>
                        </div>
                        <div class="dados-minuta">
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Motorista %}
                                <i class="bi bi-person-square">
                                    <span>{{ minutas.Motorista }}</span>
                                </i>
                                {% endif %}
                            </div>
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Veiculo %}
                                <i class="bi bi-truck">
                                    <span>{{ minutas.Veiculo }}</span>
                                </i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="icones-minuta">
                        <i class="bi bi-reply-all i-button"
                                onclick="window.location.href = '{% url 'estorna_minuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-printer i-button"
                                onclick="window.location.href = '{% url 'imprimeminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'consultaminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'minuta' minutas.idMinuta %}'">
                        </i>
                    </div>
                </div>
                <div class="linha-divisoria"></div>
                {% endfor %}
                <div class="article-minuta-rodape">
                    {% if t_concluida %}
                        {% if t_concluida == 1 %}
                        <span>{{ t_concluida }} MINUTA CONCLUÍDA </span>
                        {% else %}
                        <span>{{ t_concluida }} MINUTAS CONCLUÍDAS </span>
                        {% endif %}
                    {% else %}
                    <span>NENHUMA MINUTA CONCLUÍDA </span>
                    {% endif %}
                </div>
            </article>
            <article class="article-card ac-lista">
                <div class="article-minuta-titulo">
                    <span>FECHADA</span>
                </div>
                {% for minutas in m_fechada %}
                <div class="ac-minuta-base">
                    <div class="ac-itens">
                        <div class="dados-minuta">
                            <div class="linha-minuta"> 
                                <i class="bi bi-file-text">
                                    <span>{{ minutas.Minuta }}</span> 
                                    <span>{{ minutas.Data }}</span>
                                    <span>{{ minutas.Hora }}</span>
                                </i> 
                            </div>
                            <div class="linha-minuta">
                                <i class="bi bi-building">
                                    <span>{{ minutas.Cliente }}</span>
                                </i>
                            </div>
                        </div>
                        <div class="dados-minuta">
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Motorista %}
                                <i class="bi bi-person-square">
                                    <span>{{ minutas.Motorista }}</span>
                                </i>
                                {% endif %}
                            </div>
                            <div class="linha-minuta linha-motorista">
                                {% if minutas.Veiculo %}
                                <i class="bi bi-truck">
                                    <span>{{ minutas.Veiculo }}</span>
                                </i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="icones-minuta">
                        <i class="bi bi-reply-all i-button"
                                onclick="window.location.href = '{% url 'estorna_minuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-printer i-button"
                                onclick="window.location.href = '{% url 'imprimeminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'consultaminuta' minutas.idMinuta %}'">
                        </i>
                        <i class="bi bi-folder i-button"
                                onclick="window.location.href = '{% url 'minuta' minutas.idMinuta %}'">
                        </i>
                    </div>
                </div>
                <div class="linha-divisoria"></div>
                {% endfor %}
                <div class="article-minuta-rodape">
                    {% if t_fechada %}
                        {% if t_fechada == 1 %}
                        <span>{{ t_fechada }} MINUTA FECHADA </span>
                        {% else %}
                        <span>{{ t_fechada }} MINUTAS FECHADAS </span>
                        {% endif %}
                    {% else %}
                    <span>NENHUMA MINUTA FECHADA </span>
                    {% endif %}
                </div>
            </article>
        </div>
    </div>    
    <div class="col-02">
        <div class="i-adicionar-minuta">
            <i class="bi bi-plus-square i-button" onclick="openMyModal(event); return false;"
               data-title="CADASTRA MINUTA" data-action="{% url 'adicionaminuta' %}" data-button-save-label="SALVAR">
                NOVA MINUTA</i>
        </div>
    </div>

    <!-- div modal -->
    <div class="modal fade bd-example-modal-lg" id="MyModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title"><b>CADASTRO DE CLIENTE</b></h4>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">FECHAR</button>
                    <button type="submit" class="btn btn-success btn-save">CRIAR</button>
                </div>
            </div>
        </div>
    </div>
</main>


<!-- DIV MODAL -->
<div class="modal fade" id="modal-formulario" >
    <div class="modal-dialog">
        <div class="modal-content">

        </div>
    </div>
</div>
{% endblock %}



<!--


<div class="lista_conteudo">
    <header>
        <h4>CADASTRO DE MINUTAS</h4>
    </header>
    <div class="nav_filtro">
        <div>
            <div class="filtro">
                <form>
                    <input type="text" class="filtrotexto" placeholder="FILTRAR MINUTA..." name="filtrominuta"/>
                    {% if user|can:'filtra_minuta' %}
                    <button type="submit" class="btn btn-info glyphicon glyphicon-search"></button>
                    {% endif %}
                </form>
            </div>
            <div class="filtro">
                <form>
                    <select class="filtrotexto" name="filtrostatus">
                        <option value="" disable selected>FILTRAR STATUS...</option>
                        {% for minuta_status in minuta_status %}
                            <option value="{{ minuta_status }}">{{ minuta_status }}</option>
                        {% endfor %}
                    </select>
                    {% if user|can:'filtra_minuta' %}
                    <button type="submit" class="btn btn-info glyphicon glyphicon-search"></button>
                    {% endif %}
                </form>
            </div>
        </div>
        <div class="add_registro">
            {% if user|can:'cria_minuta' %}
            <button type="button" class="btn btn-success glyphicon glyphicon-plus js-criaminuta"
                    data-url="{% url 'criaminuta' %}"></button>
            {% endif %}
        </div>
    </div>
    <div>
        <table class="tabela">
            <thead>
                <tr class="tabelatitulo">
                    <th class="primeiracoluna">MINUTA</th>
                    <th>DATA</th>
                    <th>HORA</th>
                    <th>CLIENTE</th>
                    <th>MOTORISTA</th>
                    <th>VEÍCULO</th>
                    <th>PLACA</th>
                    <th>STATUS</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for itens in minuta %}
                    <tr class="tabelalinha">
                        <td class="primeiracoluna"> {{ itens.Minuta }}</td>
                        <td>{{ itens.DataMinuta }}</td>
                        <td>{{ itens.HoraInicial }}</td>
                        <td>{{ itens.idCliente.Fantasia }}</td>
                        <td>
                            {% for itensmotorista in minutacolaboradores %}
                            {% if itens.idMinuta == itensmotorista.idMinuta_id %}
                            {{ itensmotorista.idPessoal.Nome }}
                            {% endif %}
                            {% endfor %}
                        </td>
                        <td>{{ itens.idVeiculo.Modelo }}</td>
                        <td>{{ itens.idVeiculo.Placa }}</td>
                        <td>{{ itens.StatusMinuta }}</td>
                        <td class="seleciona_registo">
                            {% if itens.StatusMinuta == 'FECHADA' or itens.StatusMinuta == 'CONCLUIDA'%}
                            {% if user|can:'estorna_minuta' %}
                            <button class="btn btn-danger btn-xs glyphicon glyphicon-backward"
                                    onclick="window.location.href = '{% url 'estorna_minuta' itens.idMinuta %}'">
                            </button>
                            {% endif %}
                            {% endif %}
                            <button class="btn btn-warning btn-xs glyphicon glyphicon-print"
                                    onclick="window.location.href = '{% url 'imprimeminuta' itens.idMinuta %}'">
                            </button>
                            <button class="btn btn-primary btn-xs glyphicon glyphicon-folder-open"
                                    onclick="window.location.href = '{% url 'consultaminuta' itens.idMinuta %}'">
                            </button>
                            <i class="bi bi-folder"
                               onclick="window.location.href = '{% url 'minuta' itens.idMinuta %}'"></i>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <footer>
        {% for itens in minuta %}
            {% if forloop.last %}
                <h5> {{ forloop.counter }} Registros de minutas listadas.</h5>
            {% endif %}
        {% endfor %}
    </footer>
</div>

    
-->